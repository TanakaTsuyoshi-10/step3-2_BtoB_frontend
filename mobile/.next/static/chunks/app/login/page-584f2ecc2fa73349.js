(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{867:(e,a,s)=>{"use strict";s.d(a,{O5:()=>n,R2:()=>t});let r=s(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api",l=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(r).concat(e),l=localStorage.getItem("authToken"),t={headers:{"Content-Type":"application/json",...l&&{Authorization:"Bearer ".concat(l)},...a.headers},...a};try{let e=await fetch(s,t);if(!e.ok){let a,s=await e.text();try{a=JSON.parse(s)}catch(e){console.warn("Failed to parse error response as JSON:",e),a={error:"Network error"}}throw Error(a.error||"HTTP ".concat(e.status))}let a=await e.text();try{return JSON.parse(a)}catch(e){throw console.error("Failed to parse response as JSON:",e),console.error("Response text:",a),Error("Invalid JSON response from server")}}catch(e){throw console.error("API Error:",e),e}},t={login:e=>l("/auth/login",{method:"POST",body:JSON.stringify(e)}),register:e=>l("/auth/register",{method:"POST",body:JSON.stringify(e)}),getProfile:()=>l("/auth/profile"),updateProfile:e=>l("/auth/profile",{method:"PUT",body:JSON.stringify(e)})},n=e=>{localStorage.setItem("authToken",e)}},5902:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>d});var r=s(5155),l=s(2115),t=s(2619),n=s.n(t),o=s(63),c=s(2262),i=s(867);function d(){let e=(0,o.useRouter)(),[a,s]=(0,l.useState)("general"),[t,d]=(0,l.useState)(!1),[m,p]=(0,l.useState)(""),[h,u]=(0,l.useState)({email:"",password:"",companyCode:"",employeeId:"",userName:"",department:"",customerNumber:""}),x=e=>{u({...h,[e.target.name]:e.target.value})},b=async s=>{s.preventDefault(),d(!0),p("");try{let s="tokyogas"===a?{customerNumber:h.customerNumber,password:h.password,loginType:"tokyogas"}:{email:h.email,password:h.password,companyCode:h.companyCode,employeeId:h.employeeId,userName:h.userName,department:h.department,loginType:"general"},r=await i.R2.login(s);if(r.token)(0,i.O5)(r.token),e.push("/dashboard");else throw Error("認証トークンが取得できませんでした")}catch(e){p(e.message||"ログインに失敗しました"),console.error("Login error:",e)}finally{d(!1)}};return(0,r.jsx)("div",{className:"min-h-screen bg-custom flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"card w-full max-w-md bg-white shadow-2xl",children:(0,r.jsxs)("div",{className:"card-body",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)(n(),{href:"/",className:"text-2xl font-bold text-primary hover:text-primary/80",children:"Tech0 by scope3"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"企業向けエネルギー管理"})]}),(0,r.jsxs)("div",{className:"tabs tabs-custom mb-6",children:[(0,r.jsx)("button",{className:"tab tab-sm sm:tab-lg flex-1 ".concat("general"===a?"tab-active":""),onClick:()=>s("general"),children:"一般ログイン"}),(0,r.jsxs)("button",{className:"tab tab-sm sm:tab-lg flex-1 ".concat("tokyogas"===a?"tab-active":""),onClick:()=>s("tokyogas"),children:[(0,r.jsx)("span",{className:"hidden sm:inline",children:"東京ガス連携"}),(0,r.jsx)("span",{className:"sm:hidden",children:"東京ガス"})]})]}),m&&(0,r.jsx)("div",{className:"alert alert-error mb-4",children:(0,r.jsx)("span",{children:m})}),(0,r.jsxs)("form",{onSubmit:b,className:"space-y-4",children:["tokyogas"===a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("p",{className:"text-center text-primary font-medium",children:"東京ガスのお客さま番号でログインできます"})}),(0,r.jsxs)("div",{className:"form-control",children:[(0,r.jsx)("label",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"お客さま番号"})}),(0,r.jsx)("input",{type:"text",name:"customerNumber",placeholder:"お客さま番号を入力",className:"input input-bordered",value:h.customerNumber||"",onChange:x,required:!0})]}),(0,r.jsxs)("div",{className:"form-control",children:[(0,r.jsx)("label",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"パスワード"})}),(0,r.jsx)("input",{type:"password",name:"password",placeholder:"パスワードを入力",className:"input input-bordered",value:h.password,onChange:x,required:!0})]}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary w-full btn-md sm:btn-lg",disabled:t,children:t?(0,r.jsx)("span",{className:"loading loading-spinner loading-sm"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.In,{icon:"carbon:connect",className:"text-lg"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"東京ガスアカウントで"}),"ログイン"]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"form-control",children:[(0,r.jsx)("label",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"会社コード"})}),(0,r.jsx)("input",{type:"text",name:"companyCode",placeholder:"会社コードを入力",className:"input input-bordered",value:h.companyCode,onChange:x,required:!0})]}),(0,r.jsxs)("div",{className:"form-control",children:[(0,r.jsx)("label",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"社員番号"})}),(0,r.jsx)("input",{type:"text",name:"employeeId",placeholder:"社員番号を入力",className:"input input-bordered",value:h.employeeId,onChange:x,required:!0})]}),(0,r.jsxs)("div",{className:"form-control",children:[(0,r.jsx)("label",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"メールアドレス"})}),(0,r.jsx)("input",{type:"email",name:"email",placeholder:"メールアドレスを入力",className:"input input-bordered",value:h.email,onChange:x,required:!0})]}),(0,r.jsxs)("div",{className:"form-control",children:[(0,r.jsx)("label",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"お名前"})}),(0,r.jsx)("input",{type:"text",name:"userName",placeholder:"お名前を入力",className:"input input-bordered",value:h.userName,onChange:x,required:!0})]}),(0,r.jsxs)("div",{className:"form-control",children:[(0,r.jsx)("label",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"部署"})}),(0,r.jsx)("input",{type:"text",name:"department",placeholder:"部署名を入力",className:"input input-bordered",value:h.department,onChange:x,required:!0})]}),(0,r.jsxs)("div",{className:"form-control",children:[(0,r.jsx)("label",{className:"label",children:(0,r.jsx)("span",{className:"label-text",children:"パスワード"})}),(0,r.jsx)("input",{type:"password",name:"password",placeholder:"パスワードを入力",className:"input input-bordered",value:h.password,onChange:x,required:!0})]}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary w-full btn-md sm:btn-lg",disabled:t,children:t?(0,r.jsx)("span",{className:"loading loading-spinner loading-sm"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.In,{icon:"carbon:login",className:"text-lg"}),"ログイン"]})})]}),(0,r.jsx)("div",{className:"divider",children:"または"}),(0,r.jsx)("div",{className:"space-y-3",children:(0,r.jsxs)("button",{type:"button",className:"btn btn-outline w-full btn-md",children:[(0,r.jsx)(c.In,{icon:"carbon:chat",className:"text-lg"}),"LINEでログイン"]})}),(0,r.jsx)("div",{className:"text-center mt-6",children:(0,r.jsx)(n(),{href:"/register",className:"link link-primary",children:"アカウントをお持ちでない方はこちら"})})]})]})})})}},6342:(e,a,s)=>{Promise.resolve().then(s.bind(s,5902))}},e=>{e.O(0,[195,441,255,358],()=>e(e.s=6342)),_N_E=e.O()}]);